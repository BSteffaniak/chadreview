[package]
authors     = { workspace = true }
categories  = ["development-tools"]
description = "HyperChad-based application for ChadReview"
edition     = { workspace = true }
keywords    = ["app", "github"]
license     = { workspace = true }
name        = "chadreview_app"
readme      = "README.md"
repository  = { workspace = true }
version     = { workspace = true }

[package.metadata.cargo-machete]
ignored = [
    "chadreview_ai_provider",
    "chadreview_ai_provider_models",
    "chadreview_app_ui",
    "chadreview_git_backend",
    "chadreview_git_backend_git2",
    "chadreview_local_diff",
    "chadreview_local_diff_models",
    "chadreview_opencode_provider",
    "chadreview_relay_models",
    "chadreview_state",
    "hyperchad_template",
    "hyperchad_transformer",
    "tokio",
]

[[bin]]
name = "chadreview"
path = "src/main.rs"

[dependencies]
anyhow = { workspace = true }
hyperchad = { workspace = true, features = [
    "actions",
    "app",
    "renderer",
    "router",
    "router-form",
    "template",
    "transformer",
] }
hyperchad_template = { workspace = true, default-features = false }
hyperchad_transformer = { workspace = true, default-features = false }
log = { workspace = true }
moosicbox_logging = { workspace = true, features = ["free_log"] }
serde = { workspace = true }
serde_json = { workspace = true }
switchy = { workspace = true, default-features = false, features = [
    "async-tokio",
    "http",
    "uuid-uuid",
] }
thiserror = { workspace = true }

chadreview_app_ui       = { workspace = true }
chadreview_diff_models  = { workspace = true }
chadreview_git_provider = { workspace = true }
chadreview_github       = { workspace = true }
chadreview_pr_models    = { workspace = true }
chadreview_relay_client = { workspace = true }
chadreview_relay_models = { workspace = true }
chadreview_state        = { workspace = true }

# Optional dependencies for local git support
chadreview_git_backend          = { workspace = true, optional = true }
chadreview_git_backend_git2     = { workspace = true, optional = true }
chadreview_local_comment        = { workspace = true, optional = true }
chadreview_local_comment_models = { workspace = true, optional = true }
chadreview_local_diff           = { workspace = true, optional = true }
chadreview_local_diff_models    = { workspace = true, optional = true }
chrono                          = { workspace = true, features = ["clock", "std"], optional = true }
urlencoding                     = { workspace = true, optional = true }

# Optional dependencies for AI integration
chadreview_ai_provider        = { workspace = true, optional = true }
chadreview_ai_provider_models = { workspace = true, optional = true }
chadreview_opencode_provider  = { workspace = true, optional = true }

[features]
default = ["assets"]

bitbucket = []
github = []
gitlab = []
local-git = [
    "chadreview_app_ui/local-git",
    "dep:chadreview_git_backend",
    "dep:chadreview_git_backend_git2",
    "dep:chadreview_local_comment",
    "dep:chadreview_local_comment_models",
    "dep:chadreview_local_diff",
    "dep:chadreview_local_diff_models",
    "dep:chrono",
    "dep:urlencoding",
]

# Hidden/internal feature for AI integration base - not for direct use
_ai-integration = [
    "dep:chadreview_ai_provider",
    "dep:chadreview_ai_provider_models",
    "local-git",
]

# Public feature for OpenCode AI integration
ai-integration-opencode = [
    "_ai-integration",
    "dep:chadreview_opencode_provider",
]

actix = ["hyperchad/renderer-html-actix", "hyperchad/renderer-html-sse"]
assets = ["hyperchad/renderer-assets"]
dev = [
    "assets",
    "hyperchad/renderer-vanilla-js-plugin-uuid-insecure",
    "static-routes",
]
egui-glow = ["hyperchad/renderer-egui-glow"]
egui-wgpu = ["hyperchad/renderer-egui-wgpu"]
fltk = ["hyperchad/renderer-fltk"]
html = ["hyperchad/renderer-html"]
lambda = ["hyperchad/renderer-html-lambda"]
static-routes = ["hyperchad/router-static-routes"]
vanilla-js = [
    "html",
    "hyperchad/renderer-vanilla-js",
    "hyperchad/renderer-vanilla-js-plugin-actions",
    "hyperchad/renderer-vanilla-js-plugin-event",
    "hyperchad/renderer-vanilla-js-plugin-form",
    "hyperchad/renderer-vanilla-js-plugin-http-events",
    "hyperchad/renderer-vanilla-js-plugin-idiomorph",
    "hyperchad/renderer-vanilla-js-plugin-nav",
    "hyperchad/renderer-vanilla-js-plugin-routing",
    "hyperchad/renderer-vanilla-js-plugin-sse",
    "hyperchad/renderer-vanilla-js-plugin-uuid",
]

fail-on-warnings = []

[dev-dependencies]
